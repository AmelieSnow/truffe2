{% extends "generic/datatables_json.html" %}
{% load i18n %}
{% load generic_extras %}
{% load rights_extras %}

{% block data %}
[
    {% for elem in list %}
      [
      {% for field, __ in Model.MetaData.list_display %}
      "{% nocrlf %}
        {% if forloop.first %}
            {% ifhasright elem user 'SHOW' %}
                <a href=\"{% url show_view elem.pk %}\">
            {% endifhasright %}
        {% endif %}
        {% if field in Model.MetaData.yes_or_no_fields %}
            {% with val=elem|get_attr:field %}{% include "generic/yesorno.html" %}{% endwith %}
        {% else %}
            {% if field in Model.MetaData.datetime_fields %}
                {{elem|get_attr:field|date:"Y.m.d"|force_escape|escapejs}} {{elem|get_attr:field|time:"H:i:s"|force_escape|escapejs}}
            {% else %}
                {% if field == 'status' and elem.MetaState.states %}
                    <span class='label label-{{elem.status_color}}'><i class='{{elem.status_icon}}'></i> {{elem.get_status_display|force_escape|escapejs}}</span>
                {% else %}
                    {% if field in Model.MetaData.safe_fields %}
                        {{elem|get_attr:field|escapejs}}
                    {% else %}
                        {{elem|get_attr:field|force_escape|escapejs}}
                    {% endif %}
                {% endif %}
            {% endif %}
        {% endif %}
        {% if forloop.first %}
            {% ifhasright elem user 'SHOW' %}</a>{% endifhasright %}
        {% endif %}{% endnocrlf %}",
      {% endfor %}
        "{% ifhasright elem user 'DELETE' %}<a href=\"{% url delete_view elem.pk %}\" class=\"btn btn-xs btn-danger\"><i class=\"fa fa-times\"></i> {% trans "Supprimer" %}</a>{% endifhasright %} {% ifhasright elem user 'EDIT' %}<a href=\"{% url edit_view elem.pk %}\" class=\"btn btn-xs btn-default\"><i class=\"fa fa-pencil\"></i> {% trans "Editer" %}</a>{% endifhasright %}"
      ]{% if not forloop.last %},{% endif %}
    {% endfor %}
]
{% endblock %}
