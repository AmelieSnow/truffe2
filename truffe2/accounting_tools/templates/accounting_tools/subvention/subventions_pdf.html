{% load i18n %}
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <style>
          @page {
              size: a4 landscape;
              margin: 1cm;
              margin-bottom: 2cm;
              @frame footer {
              -pdf-frame-content: footerContent;
                bottom: 0cm;
              margin-left: 1cm;
              margin-right: 1cm;
              height: 1cm;
              }
          }
          body {
              font-family: "DejaVu Sans, Open Sans";
          }
          .tr-a {
              border-bottom: 2px black solid;
              font-weight: bold;
          }

          tr {
              border-bottom: 1px #ddd solid;
          }

          .liste {
              font-size: 15px;
              padding-top: 5px;
          }

        </style>
    </head>

    <body>
        {% for subv in subventions %}
            <h3 style="text-align: center; font-size: 20px;">{% trans "Liste des demandes de subvention pour" %} {{subv.0}}</h3>

            <table class="liste">
                <tr class="tr-a">
                    <td>{% trans "Unité" %}</td>
                    <td>{% trans "Projet" %}</td>
                    <td>{% trans "Nb. personnes attendues" %}</td>
                    <td>{% trans "Type de soutien" %}</td>
                    <td>{% trans "Demandé" %}</td>
                    <td>{% trans "Attribué" %}</td>
                    <td>{% trans "Mobilité demandée" %}</td>
                    <td>{% trans "Mobilité attribué" %}</td>

                </tr>
                {% for sub in subv.1 %}
                    <tr>
                        <td width="12%">{{sub.get_real_unit_name}}</td>
                        <td width="12%">{{sub.name}}</td>
                        <td width="12%">{{sub.total_people}}</td>
                        <td width="12%">{{sub.get_kind_display|default:0}}</td>
                        <td width="12%">{{sub.amount_asked|default:0}}</td>
                        <td width="12%">{{sub.amount_given|default:0}}</td>
                        <td width="12%">{{sub.mobility_asked|default:0}}</td>
                        <td width="12%">{{sub.mobility.given|default:0}}</td>
                    </tr>
                {% empty %}
                  <tr>
                    <td colspan="7" style="text-align:center;">{% trans "Pas de subventions pour cette année" %}</td>
                  </tr>
                {% endfor %}
            </table>
            <pdf:nextpage/>
        {% endfor %}

        {% if summary %}

            <h3 style="text-align: center; font-size: 20px;">{% trans "Résumé de toutes les demandes de subvention" %}</h3>

            <table class="liste">
                <tr class="tr-a">
                    <td rowspan="2" style="valign:middle;">{% trans "Unité" %}</td>
                    {% for year in years %}
                        <td colspan="4" style="text-align:center; border: 2px solid black;">{{year.name}}</td>
                    {% endfor %}
                </tr>
                <tr class="tr-a">
                    {% for year in years %}
                        <td style="text-align: center;">{% trans "Demandé" %}</td>
                        <td style="text-align: center;">{% trans "Attribué" %}</td>
                        <td style="text-align: center;">{% trans "Mobilité demandée" %}</td>
                        <td style="text-align: center;">{% trans "Mobilité attribué" %}</td>
                    {% endfor %}
                </tr>

                {% for summary_line in summary %}
                    <tr>
                        {% for entry in summary_line %}
                            <td style="text-align: center;">{{entry|default:0}}</td>
                        {% endfor %}
                    </tr>
                {% endfor %}
            </table>
        {% endif %}

        <div id="footerContent">{% trans "Page" %} <pdf:pagenumber/> - {% trans "Généré le" %} {{cdate|date:"d/m/Y"}} {% trans "avec Truffe2" %} - https://truffe.polylan.ch - {% trans "par" %} {{user}}</div>

    </body>

</html>
